<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>합판 구매 계산기 | Plywood Calculator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=IBM+Plex+Mono:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --wood-dark: #2c1810;
            --wood-medium: #8b5a3c;
            --wood-light: #c4956c;
            --cream: #faf6f0;
            --paper: #f5ede1;
            --accent-blue: #2d5f7f;
            --accent-orange: #d97642;
            --bright-green: #4ade80;
            --bright-red: #f87171;
            --shadow: rgba(44, 24, 16, 0.1);
            --shadow-heavy: rgba(44, 24, 16, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'IBM Plex Mono', monospace;
            background: linear-gradient(135deg, var(--paper) 0%, var(--cream) 100%);
            color: var(--wood-dark);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
            position: relative;
            overflow-x: hidden;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 0.75rem;
                align-items: flex-start;
                padding-top: 1rem;
            }
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 2px,
                    rgba(139, 90, 60, 0.02) 2px,
                    rgba(139, 90, 60, 0.02) 4px
                );
            pointer-events: none;
            z-index: 1;
        }

        .container {
            max-width: 1200px;
            width: 100%;
            position: relative;
            z-index: 2;
            animation: fadeInUp 0.8s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        @media (max-width: 768px) {
            header {
                margin-bottom: 1rem;
            }
        }

        h1 {
            font-family: 'Syne', sans-serif;
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 800;
            color: var(--wood-dark);
            letter-spacing: -0.02em;
            margin-bottom: 0.5rem;
            position: relative;
            display: inline-block;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 1.75rem;
            }
        }

        h1::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-orange), var(--accent-blue));
            border-radius: 2px;
            animation: expandWidth 0.6s ease-out 0.3s both;
        }
        
        @media (max-width: 768px) {
            h1::after {
                height: 3px;
                bottom: -6px;
            }
        }

        @keyframes expandWidth {
            from {
                width: 0;
            }
            to {
                width: 100%;
            }
        }

        .subtitle {
            font-size: 0.9rem;
            color: var(--wood-medium);
            font-weight: 300;
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }
        
        @media (max-width: 768px) {
            .subtitle {
                font-size: 0.7rem;
            }
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        @media (max-width: 968px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 1rem;
                margin-bottom: 1rem;
            }
        }

        .card {
            background: white;
            border-radius: 16px;
            padding: 1.75rem;
            box-shadow: 
                0 4px 6px var(--shadow),
                0 12px 24px var(--shadow-heavy);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            animation: cardSlideIn 0.6s ease-out both;
        }
        
        @media (max-width: 768px) {
            .card {
                padding: 1.25rem;
                border-radius: 12px;
            }
        }

        .card:nth-child(1) {
            animation-delay: 0.1s;
        }

        .card:nth-child(2) {
            animation-delay: 0.2s;
        }

        @keyframes cardSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 
                0 8px 12px var(--shadow),
                0 16px 32px var(--shadow-heavy);
        }
        
        @media (max-width: 768px) {
            .card:hover {
                transform: none;
            }
        }

        .card-title {
            font-family: 'Syne', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--wood-dark);
            margin-bottom: 1.25rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        @media (max-width: 768px) {
            .card-title {
                font-size: 1.25rem;
                margin-bottom: 1rem;
            }
        }

        .card-title::before {
            content: '';
            width: 4px;
            height: 24px;
            background: var(--accent-orange);
            border-radius: 2px;
        }

        .input-group {
            margin-bottom: 1.25rem;
        }
        
        @media (max-width: 768px) {
            .input-group {
                margin-bottom: 1rem;
            }
        }

        label {
            display: block;
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--wood-medium);
            margin-bottom: 0.5rem;
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }
        
        @media (max-width: 768px) {
            label {
                font-size: 0.75rem;
            }
        }

        .input-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        @media (max-width: 768px) {
            .input-row {
                gap: 0.75rem;
            }
        }

        .input-wrapper {
            position: relative;
        }

        input[type="number"] {
            width: 100%;
            padding: 0.875rem 1rem;
            padding-right: 3rem;
            border: 2px solid var(--paper);
            border-radius: 8px;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 1.125rem;
            font-weight: 500;
            color: var(--wood-dark);
            background: var(--cream);
            transition: all 0.3s ease;
            outline: none;
        }
        
        @media (max-width: 768px) {
            input[type="number"] {
                padding: 0.75rem 0.875rem;
                padding-right: 3rem;
                font-size: 1rem;
            }
        }

        input[type="number"]:focus {
            border-color: var(--accent-blue);
            background: white;
            box-shadow: 0 0 0 4px rgba(45, 95, 127, 0.1);
        }

        .unit {
            position: absolute;
            right: 1rem;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.875rem;
            color: var(--wood-medium);
            font-weight: 400;
            pointer-events: none;
        }
        
        @media (max-width: 768px) {
            .unit {
                font-size: 0.75rem;
                right: 0.875rem;
            }
        }

        .dimension-label {
            font-size: 0.75rem;
            color: var(--wood-medium);
            margin-bottom: 0.5rem;
        }
        
        @media (max-width: 768px) {
            .dimension-label {
                font-size: 0.7rem;
                margin-bottom: 0.4rem;
            }
        }

        .result-card {
            background: white;
            border-radius: 16px;
            padding: 1.75rem;
            box-shadow: 
                0 4px 6px var(--shadow),
                0 12px 24px var(--shadow-heavy);
            animation: cardSlideIn 0.6s ease-out 0.3s both;
            border: 2px solid var(--paper);
        }
        
        @media (max-width: 768px) {
            .result-card {
                padding: 1.25rem;
                border-radius: 12px;
            }
        }

        .result-card.show {
            animation: resultPop 0.5s ease-out;
        }

        @keyframes resultPop {
            0% {
                transform: scale(0.9);
                opacity: 0;
            }
            50% {
                transform: scale(1.02);
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .result-header {
            text-align: center;
            margin-bottom: 1.5rem;
        }
        
        @media (max-width: 768px) {
            .result-header {
                margin-bottom: 1rem;
            }
        }

        .result-number {
            font-family: 'Syne', sans-serif;
            font-size: 5rem;
            font-weight: 800;
            line-height: 1;
            margin-bottom: 0.5rem;
            transition: all 0.3s ease;
        }
        
        @media (max-width: 768px) {
            .result-number {
                font-size: 3.5rem;
            }
        }

        .result-label {
            font-size: 1.125rem;
            color: var(--wood-medium);
            font-weight: 500;
        }
        
        @media (max-width: 768px) {
            .result-label {
                font-size: 1rem;
            }
        }

        .layout-info {
            background: var(--cream);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        @media (max-width: 768px) {
            .layout-info {
                padding: 0.75rem;
                margin-bottom: 1rem;
            }
        }

        .layout-title {
            font-family: 'Syne', sans-serif;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--wood-medium);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 0.5rem;
        }

        @media (max-width: 768px) {
            .layout-title {
                font-size: 0.8rem;
            }
        }

        .layout-pattern {
            font-family: 'Syne', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-blue);
        }

        @media (max-width: 768px) {
            .layout-pattern {
                font-size: 1.2rem;
            }
        }

        .result-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 2px solid var(--paper);
        }
        
        @media (max-width: 768px) {
            .result-details {
                grid-template-columns: 1fr;
                gap: 0.75rem;
                margin-top: 1rem;
                padding-top: 1rem;
            }
        }

        .detail-item {
            text-align: center;
            padding: 1rem;
            background: var(--cream);
            border-radius: 12px;
            transition: transform 0.3s ease;
        }
        
        @media (max-width: 768px) {
            .detail-item {
                padding: 0.75rem;
            }
        }

        .detail-item:hover {
            transform: translateY(-4px);
        }
        
        @media (max-width: 768px) {
            .detail-item:hover {
                transform: none;
            }
        }

        .detail-value {
            font-family: 'Syne', sans-serif;
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--wood-dark);
            margin-bottom: 0.25rem;
        }

        .detail-label {
            font-size: 0.75rem;
            color: var(--wood-medium);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }
        
        @media (max-width: 768px) {
            .detail-value {
                font-size: 1.5rem;
            }
            
            .detail-label {
                font-size: 0.7rem;
            }
        }

        .visualization {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: var(--cream);
            border-radius: 12px;
            min-height: 250px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        @media (max-width: 768px) {
            .visualization {
                margin-top: 1rem;
                padding: 1rem;
                min-height: 200px;
            }
        }

        .sheets-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            width: 100%;
            max-width: 1000px;
        }

        @media (max-width: 768px) {
            .sheets-container {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
        }

        .sheet-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .sheet-title {
            font-family: 'Syne', sans-serif;
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--wood-dark);
            margin-bottom: 0.5rem;
            text-align: center;
        }

        @media (max-width: 768px) {
            .sheet-title {
                font-size: 0.8rem;
            }
        }

        .more-sheets {
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--wood-medium), var(--wood-dark));
            border-radius: 8px;
            color: white;
            font-family: 'Syne', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            min-height: 150px;
            box-shadow: 0 4px 12px var(--shadow);
        }

        @media (max-width: 768px) {
            .more-sheets {
                font-size: 1.2rem;
                min-height: 120px;
            }
        }

        .plywood-visual {
            background: linear-gradient(135deg, var(--wood-light), var(--wood-medium));
            border-radius: 8px;
            box-shadow: 0 4px 12px var(--shadow);
            position: relative;
            margin-bottom: 1rem;
            overflow: hidden;
        }

        .cut-area {
            position: absolute;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .cut-row {
            display: flex;
            gap: 2px;
        }

        .cut-item {
            background: rgba(255, 255, 255, 0.25);
            border: 2px solid rgba(44, 24, 16, 0.4);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--wood-dark);
            box-shadow: inset 0 1px 3px rgba(255, 255, 255, 0.3);
        }

        @media (max-width: 768px) {
            .cut-item {
                font-size: 0.65rem;
                border-width: 1.5px;
            }
        }

        .waste-area {
            position: absolute;
            background: 
                repeating-linear-gradient(
                    45deg,
                    transparent,
                    transparent 8px,
                    rgba(217, 118, 66, 0.3) 8px,
                    rgba(217, 118, 66, 0.3) 10px
                ),
                repeating-linear-gradient(
                    -45deg,
                    transparent,
                    transparent 8px,
                    rgba(217, 118, 66, 0.3) 8px,
                    rgba(217, 118, 66, 0.3) 10px
                ),
                rgba(44, 24, 16, 0.15);
            border: 2px dashed rgba(217, 118, 66, 0.6);
            border-radius: 4px;
        }

        @media (max-width: 768px) {
            .waste-area {
                background: 
                    repeating-linear-gradient(
                        45deg,
                        transparent,
                        transparent 6px,
                        rgba(217, 118, 66, 0.35) 6px,
                        rgba(217, 118, 66, 0.35) 8px
                    ),
                    repeating-linear-gradient(
                        -45deg,
                        transparent,
                        transparent 6px,
                        rgba(217, 118, 66, 0.35) 6px,
                        rgba(217, 118, 66, 0.35) 8px
                    ),
                    rgba(44, 24, 16, 0.15);
                border-width: 1.5px;
            }
        }

        .no-result {
            text-align: center;
            color: var(--wood-medium);
            font-size: 1rem;
        }
        
        @media (max-width: 768px) {
            .no-result {
                font-size: 0.85rem;
            }
        }

        footer {
            text-align: center;
            margin-top: 2rem;
            padding: 1rem;
            color: var(--wood-medium);
            font-size: 0.85rem;
        }
        
        @media (max-width: 768px) {
            footer {
                margin-top: 1.5rem;
                padding: 0.75rem;
                font-size: 0.75rem;
            }
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>합판 구매 계산기</h1>
            <p class="subtitle">Plywood Purchase Calculator</p>
        </header>

        <div class="main-content">
            <div class="card">
                <h2 class="card-title">구매 재단 사이즈</h2>
                <div class="input-group">
                    <label>재단할 크기 (가로/세로 구분 없음)</label>
                    <div class="input-row">
                        <div>
                            <div class="dimension-label">크기 1</div>
                            <div class="input-wrapper">
                                <input type="number" id="cutWidth" value="1210" min="1" onfocus="this.select()" oninput="autoCalculate()">
                                <span class="unit">mm</span>
                            </div>
                        </div>
                        <div>
                            <div class="dimension-label">크기 2</div>
                            <div class="input-wrapper">
                                <input type="number" id="cutHeight" value="1219" min="1" onfocus="this.select()" oninput="autoCalculate()">
                                <span class="unit">mm</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="input-group">
                    <label>구매 수량</label>
                    <div class="input-wrapper">
                        <input type="number" id="quantity" value="2" min="1" onfocus="this.select()" oninput="autoCalculate()">
                        <span class="unit">장</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">구매 정보</h2>
                <div class="input-group">
                    <div class="result-header">
                        <div class="result-number" id="resultNumber">0</div>
                        <div class="result-label">장의 합판을 구매해야 합니다</div>
                    </div>

                    <div class="detail-item">
                    <div class="detail-value" id="totalPrice">0원</div>
                    <div class="detail-label">총 구매 금액</div>
                </div>
            </div>
        </div>

        <div class="card">
            <h2 class="card-title">합판 규격</h2>
            <div class="input-group">
                <label>표준 합판 크기</label>
                <div class="input-row">
                    <div>
                        <div class="dimension-label">가로 (Width)</div>
                        <div class="input-wrapper">
                            <input type="number" id="sheetWidth" value="1220" min="1" onfocus="this.select()" oninput="autoCalculate()">
                            <span class="unit">mm</span>
                        </div>
                    </div>
                    <div>
                        <div class="dimension-label">세로 (Height)</div>
                        <div class="input-wrapper">
                            <input type="number" id="sheetHeight" value="2440" min="1" onfocus="this.select()" oninput="autoCalculate()">
                            <span class="unit">mm</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="input-group">
                <label>절단날 폭 (Kerf)</label>
                <div class="input-wrapper">
                    <input type="number" id="kerfWidth" value="2" min="0" step="0.1" onfocus="this.select()" oninput="autoCalculate()">
                    <span class="unit">mm</span>
                </div>
            </div>

            <div class="input-group">
                <label>합판 1장 가격</label>
                <div class="input-wrapper">
                    <input type="number" id="sheetPrice" value="25000" min="0" onfocus="this.select()" oninput="autoCalculate()">
                    <span class="unit">원</span>
                </div>

            </div>
        </div>        

        <div id="resultCard" class="result-card hidden">


            <div class="layout-info">
                <div class="layout-title">최적 배치 패턴</div>
                <div class="layout-pattern" id="layoutPattern">-</div>
            </div>

            <div class="result-details">
                <div class="detail-item">
                    <div class="detail-value" id="piecesPerSheet">0</div>
                    <div class="detail-label">합판 1장당 재단 가능</div>
                </div>
                <div class="detail-item">
                    <div class="detail-value" id="totalPieces">0</div>
                    <div class="detail-label">실제 제작 가능 개수</div>
                </div>
                <div class="detail-item">
                    <div class="detail-value" id="extraPieces">0</div>
                    <div class="detail-label">여유분</div>
                </div>
                <div class="detail-item">
                    <div class="detail-value" id="efficiency">0%</div>
                    <div class="detail-label">합판 활용률</div>
                </div>
            </div>
            
            <div class="visualization">
                <div id="visualization">
                    <div class="no-result">입력값을 변경하면 자동으로 계산됩니다</div>
                </div>
            </div>
        </div>

        <footer>
            Design inspired by modern carpentry tools & precision measurement
        </footer>
    </div>

    <script>
        // 자동 계산 함수
        function autoCalculate() {
            const sheetWidth = parseFloat(document.getElementById('sheetWidth').value);
            const sheetHeight = parseFloat(document.getElementById('sheetHeight').value);
            const cutWidth = parseFloat(document.getElementById('cutWidth').value);
            const cutHeight = parseFloat(document.getElementById('cutHeight').value);
            const quantity = parseInt(document.getElementById('quantity').value);
            const kerfWidth = parseFloat(document.getElementById('kerfWidth').value);

            if (sheetWidth > 0 && sheetHeight > 0 && cutWidth > 0 && cutHeight > 0 && quantity > 0 && kerfWidth >= 0) {
                calculate();
            }
        }

        /**
         * 에러 메시지 표시
         */
        function showError(message) {
            const resultCard = document.getElementById('resultCard');
            const visualization = document.getElementById('visualization');
            
            resultCard.classList.remove('hidden');
            visualization.innerHTML = `
                <div style="text-align: center; padding: 2rem;">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">⚠️</div>
                    <div style="color: var(--accent-orange); font-weight: 600; font-size: 1rem; line-height: 1.6;">
                        ${message}
                    </div>
                    <div style="color: var(--wood-medium); font-size: 0.85rem; margin-top: 0.5rem;">
                        합판 크기를 늘리거나 재단 크기를 줄여주세요.
                    </div>
                </div>
            `;
        }

        /**
         * 최적 배치 계산 함수
         * 2가지 회전 방향을 모두 고려하여 최대 효율 배치를 찾음
         */
        function calculate() {
            const sheetW = parseFloat(document.getElementById('sheetWidth').value);
            const sheetH = parseFloat(document.getElementById('sheetHeight').value);
            const cutW = parseFloat(document.getElementById('cutWidth').value);
            const cutH = parseFloat(document.getElementById('cutHeight').value);
            const kerf = parseFloat(document.getElementById('kerfWidth').value);
            const quantity = parseInt(document.getElementById('quantity').value);

            // 유효성 검사
            if (sheetW <= 0 || sheetH <= 0 || cutW <= 0 || cutH <= 0 || quantity <= 0 || kerf < 0) {
                return;
            }

            // 방법 1: 요청 사이즈를 그대로 배치 (cutW × cutH)
            const layout1 = calculateLayout(sheetW, sheetH, cutW, cutH, kerf);
            
            // 방법 2: 요청 사이즈를 90도 회전 배치 (cutH × cutW)
            const layout2 = calculateLayout(sheetW, sheetH, cutH, cutW, kerf);

            // 더 많이 들어가는 배치 선택
            let bestLayout = layout1.piecesPerSheet >= layout2.piecesPerSheet ? layout1 : layout2;

            // 재단 불가능한 경우 (이론적으로는 autoCalculate에서 걸러지지만)
            if (bestLayout.piecesPerSheet === 0) {
                showError(`재단 크기(${cutW}×${cutH}mm)가 합판(${sheetW}×${sheetH}mm)보다 커서 재단이 불가능합니다.`);
                return;
            }            
            // // 재단 불가능한 경우
            // if (bestLayout.piecesPerSheet === 0) {
            //     document.getElementById('resultCard').classList.add('hidden');
            //     alert(`재단 크기(${cutW}×${cutH})가 합판(${sheetW}×${sheetH})보다 커서 재단이 불가능합니다!`);
            //     return;
            // }

            // 필요한 합판 수 계산
            const requiredBoards = Math.ceil(quantity / bestLayout.piecesPerSheet);
            const totalPieces = requiredBoards * bestLayout.piecesPerSheet;
            const extraPieces = totalPieces - quantity;

            // 활용률 계산
            const cutArea = cutW * cutH;
            const sheetArea = sheetW * sheetH;
            const efficiency = ((quantity * cutArea) / (requiredBoards * sheetArea) * 100).toFixed(1);

            // 가격 계산
            const sheetPrice = parseFloat(document.getElementById('sheetPrice').value) || 0;
            const totalPrice = requiredBoards * sheetPrice;

            // 결과 표시
            const resultNumberElement = document.getElementById('resultNumber');
            resultNumberElement.textContent = requiredBoards;
            resultNumberElement.style.background = 'linear-gradient(135deg, var(--bright-green), #22c55e)';
            resultNumberElement.style.webkitBackgroundClip = 'text';
            resultNumberElement.style.webkitTextFillColor = 'transparent';
            resultNumberElement.style.backgroundClip = 'text';

            document.getElementById('layoutPattern').textContent = 
                `${bestLayout.cols}열 × ${bestLayout.rows}행 (${bestLayout.orientation === 'normal' ? cutW + '×' + cutH : cutH + '×' + cutW})`;
            1210
            document.getElementById('piecesPerSheet').textContent = bestLayout.piecesPerSheet;
            // document.getElementById('requiredPieces').textContent = quantity;
            document.getElementById('totalPieces').textContent = totalPieces;
            
            const extraPiecesElement = document.getElementById('extraPieces');
            extraPiecesElement.textContent = extraPieces;
            // 여유분이 있으면 파란색, 없으면 기본색
            if (extraPieces > 0) {
                extraPiecesElement.style.color = 'var(--accent-blue)';
            } else {
                extraPiecesElement.style.color = 'var(--wood-dark)';
            }
            
            document.getElementById('efficiency').textContent = efficiency + '%';
            
            const totalPriceElement = document.getElementById('totalPrice');
            totalPriceElement.textContent = totalPrice.toLocaleString() + '원';
            totalPriceElement.style.color = 'var(--bright-red)';

            // 시각화
            visualizeCutting(sheetW, sheetH, bestLayout, requiredBoards, quantity);

            // 결과 카드 표시
            const resultCard = document.getElementById('resultCard');
            resultCard.classList.remove('hidden');
            
            if (!resultCard.classList.contains('show')) {
                resultCard.classList.add('show');
            }
        }

        /**
         * 특정 배치에서 몇 개를 재단할 수 있는지 계산
         */
        function calculateLayout(sheetW, sheetH, pieceW, pieceH, kerf) {
            // 재단 불가능 체크
            if (pieceW > sheetW || pieceH > sheetH) {
                return {
                    cols: 0,
                    rows: 0,
                    piecesPerSheet: 0,
                    orientation: 'none',
                    pieceW: pieceW,
                    pieceH: pieceH,
                    usedWidth: 0,
                    usedHeight: 0
                };
            }

            // 가로 방향으로 몇 개 들어가는지 (마지막 조각 제외하고 kerf 포함)
            let cols = 1;
            let usedWidth = pieceW;
            while (usedWidth + kerf + pieceW <= sheetW) {
                cols++;
                usedWidth += kerf + pieceW;
            }

            // 세로 방향으로 몇 개 들어가는지 (마지막 조각 제외하고 kerf 포함)
            let rows = 1;
            let usedHeight = pieceH;
            while (usedHeight + kerf + pieceH <= sheetH) {
                rows++;
                usedHeight += kerf + pieceH;
            }

            const piecesPerSheet = cols * rows;

            return {
                cols: cols,
                rows: rows,
                piecesPerSheet: piecesPerSheet,
                orientation: (pieceW === parseFloat(document.getElementById('cutWidth').value)) ? 'normal' : 'rotated',
                pieceW: pieceW,
                pieceH: pieceH,
                usedWidth: usedWidth,
                usedHeight: usedHeight
            };
        }

        /**
         * 재단 패턴 시각화 - 모든 구매 합판 표시
         */
        function visualizeCutting(sheetW, sheetH, layout, requiredBoards, totalQuantity) {
            const visualization = document.getElementById('visualization');
            visualization.innerHTML = '';

            if (layout.piecesPerSheet === 0) {
                visualization.innerHTML = '<div class="no-result">재단 불가능</div>';
                return;
            }

            const kerf = parseFloat(document.getElementById('kerfWidth').value);
            const isMobile = window.innerWidth <= 768;
            
            // 최대 6장까지만 표시
            const maxDisplay = 6;
            const displayBoards = Math.min(requiredBoards, maxDisplay);
            const hasMore = requiredBoards > maxDisplay;

            // 합판들을 담을 컨테이너
            const sheetsContainer = document.createElement('div');
            sheetsContainer.className = 'sheets-container';

            let pieceCounter = 0; // 전체 조각 번호 카운터

            // 각 합판 표시
            for (let sheetNum = 1; sheetNum <= displayBoards; sheetNum++) {
                const sheetWrapper = document.createElement('div');
                sheetWrapper.className = 'sheet-wrapper';

                // 합판 제목
                const sheetTitle = document.createElement('div');
                sheetTitle.className = 'sheet-title';
                sheetTitle.textContent = `합판 #${sheetNum}`;
                sheetWrapper.appendChild(sheetTitle);

                // 이 합판에 들어갈 조각 수 계산
                let piecesInThisSheet = layout.piecesPerSheet;
                if (sheetNum === requiredBoards) {
                    // 마지막 합판은 필요한 개수만
                    const remainingPieces = totalQuantity - (pieceCounter);
                    piecesInThisSheet = remainingPieces;
                }

                // 합판 시각화
                const plywoodVisual = createPlywoodVisual(
                    sheetW, sheetH, layout, kerf, 
                    pieceCounter, piecesInThisSheet, isMobile
                );
                sheetWrapper.appendChild(plywoodVisual);

                pieceCounter += piecesInThisSheet;
                sheetsContainer.appendChild(sheetWrapper);
            }

            // "+N장 더" 표시
            if (hasMore) {
                const moreWrapper = document.createElement('div');
                moreWrapper.className = 'sheet-wrapper';
                
                const moreSheets = document.createElement('div');
                moreSheets.className = 'more-sheets';
                moreSheets.textContent = `+${requiredBoards - maxDisplay}장`;
                moreWrapper.appendChild(moreSheets);
                
                sheetsContainer.appendChild(moreWrapper);
            }

            visualization.appendChild(sheetsContainer);

            // 전체 통계 정보
            const summaryInfo = document.createElement('div');
            summaryInfo.style.textAlign = 'center';
            summaryInfo.style.fontSize = isMobile ? '0.75rem' : '0.85rem';
            summaryInfo.style.color = 'var(--wood-medium)';
            summaryInfo.style.marginTop = '1rem';
            summaryInfo.style.lineHeight = '1.5';
            summaryInfo.style.paddingTop = '1rem';
            summaryInfo.style.borderTop = '2px solid var(--paper)';
            
            const usedArea = ((layout.usedWidth * layout.usedHeight) / (sheetW * sheetH) * 100).toFixed(1);
            const wasteArea = (100 - usedArea).toFixed(1);
            
            summaryInfo.innerHTML = `
                <span style="color: var(--accent-blue); font-weight: 600;">평균 사용 영역: ${usedArea}%</span> | 
                <span style="color: var(--accent-orange); font-weight: 600;">평균 낭비 영역: ${wasteArea}%</span>
            `;
            visualization.appendChild(summaryInfo);
        }

        /**
         * 개별 합판 시각화 생성
         */
        function createPlywoodVisual(sheetW, sheetH, layout, kerf, startPieceNum, piecesCount, isMobile) {
            // 시각화 크기 계산
            const maxWidth = isMobile ? 250 : 280;
            const maxHeight = isMobile ? 280 : 320;
            const scale = Math.min(maxWidth / sheetW, maxHeight / sheetH);
            
            const visualW = sheetW * scale;
            const visualH = sheetH * scale;

            // 합판 컨테이너
            const plywoodVisual = document.createElement('div');
            plywoodVisual.className = 'plywood-visual';
            plywoodVisual.style.width = visualW + 'px';
            plywoodVisual.style.height = visualH + 'px';

            // 재단 조각들이 들어갈 영역
            const cutArea = document.createElement('div');
            cutArea.className = 'cut-area';
            cutArea.style.left = '0';
            cutArea.style.top = '0';
            cutArea.style.width = (layout.usedWidth * scale) + 'px';
            cutArea.style.height = (layout.usedHeight * scale) + 'px';

            let pieceIndex = startPieceNum;
            let displayedPieces = 0;
            
            // 행별로 재단 조각 배치
            for (let row = 0; row < layout.rows; row++) {
                const cutRow = document.createElement('div');
                cutRow.className = 'cut-row';
                
                for (let col = 0; col < layout.cols; col++) {
                    pieceIndex++;
                    displayedPieces++;
                    
                    const cutItem = document.createElement('div');
                    cutItem.className = 'cut-item';
                    cutItem.style.width = (layout.pieceW * scale) + 'px';
                    cutItem.style.height = (layout.pieceH * scale) + 'px';
                    
                    // 필요한 개수만 번호 표시, 나머지는 빈 영역
                    if (displayedPieces <= piecesCount) {
                        cutItem.textContent = `#${pieceIndex}`;
                        cutItem.style.background = 'rgba(255, 255, 255, 0.25)';
                    } else {
                        cutItem.textContent = '';
                        cutItem.style.background = 'rgba(44, 24, 16, 0.05)';
                        cutItem.style.borderStyle = 'dashed';
                        cutItem.style.opacity = '0.4';
                    }
                    
                    cutRow.appendChild(cutItem);
                    
                    // 마지막 열이 아니면 kerf 간격 추가
                    if (col < layout.cols - 1) {
                        const kerfSpace = document.createElement('div');
                        kerfSpace.style.width = (kerf * scale) + 'px';
                        kerfSpace.style.height = (layout.pieceH * scale) + 'px';
                        cutRow.appendChild(kerfSpace);
                    }
                }
                
                cutArea.appendChild(cutRow);
                
                // 마지막 행이 아니면 kerf 간격 추가
                if (row < layout.rows - 1) {
                    const kerfRow = document.createElement('div');
                    kerfRow.style.height = (kerf * scale) + 'px';
                    cutArea.appendChild(kerfRow);
                }
            }

            plywoodVisual.appendChild(cutArea);

            // 오른쪽 낭비 영역
            const wasteRight = sheetW - layout.usedWidth;
            if (wasteRight > 1) {
                const wasteAreaRight = document.createElement('div');
                wasteAreaRight.className = 'waste-area';
                wasteAreaRight.style.left = (layout.usedWidth * scale) + 'px';
                wasteAreaRight.style.top = '0';
                wasteAreaRight.style.width = (wasteRight * scale) + 'px';
                wasteAreaRight.style.height = visualH + 'px';
                plywoodVisual.appendChild(wasteAreaRight);
            }

            // 아래쪽 낭비 영역
            const wasteBottom = sheetH - layout.usedHeight;
            if (wasteBottom > 1) {
                const wasteAreaBottom = document.createElement('div');
                wasteAreaBottom.className = 'waste-area';
                wasteAreaBottom.style.left = '0';
                wasteAreaBottom.style.top = (layout.usedHeight * scale) + 'px';
                wasteAreaBottom.style.width = (layout.usedWidth * scale) + 'px';
                wasteAreaBottom.style.height = (wasteBottom * scale) + 'px';
                plywoodVisual.appendChild(wasteAreaBottom);
            }

            // 오른쪽 아래 코너 낭비 영역
            if (wasteRight > 1 && wasteBottom > 1) {
                const wasteCorner = document.createElement('div');
                wasteCorner.className = 'waste-area';
                wasteCorner.style.left = (layout.usedWidth * scale) + 'px';
                wasteCorner.style.top = (layout.usedHeight * scale) + 'px';
                wasteCorner.style.width = (wasteRight * scale) + 'px';
                wasteCorner.style.height = (wasteBottom * scale) + 'px';
                plywoodVisual.appendChild(wasteCorner);
            }

            // 각 합판의 재단 개수 표시
            const pieceCountLabel = document.createElement('div');
            pieceCountLabel.style.textAlign = 'center';
            pieceCountLabel.style.fontSize = isMobile ? '0.7rem' : '0.75rem';
            pieceCountLabel.style.color = 'var(--wood-medium)';
            pieceCountLabel.style.marginTop = '0.5rem';
            pieceCountLabel.textContent = `${piecesCount}개 재단`;
            
            const wrapper = document.createElement('div');
            wrapper.appendChild(plywoodVisual);
            wrapper.appendChild(pieceCountLabel);
            
            return wrapper;
        }

        // 페이지 로드 시 초기 계산
        document.addEventListener('DOMContentLoaded', function() {
            autoCalculate();
        });
    </script>
</body>
</html>
